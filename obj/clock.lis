                         .area text
                       ;  IX -> 0,x
                       ;          clock -> 2,x
                       ;          ?temp -> 8,x
 0000                 _clock_reset::
 0000 BD0000            jsr __enterb
 0003 46                .byte 0x46
 0004                 clock.9::	
                       ; 
                       ; #include "clock.h"
                       ; #include "types.h"
                       ; 
                       ; ////////////////////////////////////////////////////////////////////////////////
                       ; 
                       ; PRESTO_TIME_T clock_reset(void) {
                       ;    PRESTO_TIME_T clock;
                       ;    clock.l=0;
 0004 CC0000            ldd #0
 0007 ED04              std 4,x
 0009                 clock.10::	
                       ;    clock.h=0;
 0009 CC0000            ldd #0
 000C ED02              std 2,x
 000E                 clock.11::	
                       ;    return clock;
 000E EC00              ldd 0,x
 0010 C30002            addd #2
 0013 188F              xgdy
 0015 EC08              ldd 8,x
 0017 3C                pshx
 0018 8F                xgdx
 0019 CC0004            ldd #4
 001C BD0000            jsr __asgnblk
 001F 38                pulx
 0020                 L5:
 0020 8F                xgdx
 0021 C30006            addd #6
 0024 8F                xgdx
 0025 35                txs
 0026 38                pulx
 0027 1838              puly
 0029 39                rts
                       ;  IX -> 0,x
                       ;          ?temp -> 2,x
                       ;           time -> 12,x
                       ;          clock -> 10,x
                       ;          ?temp -> 6,x
 002A                 _clock_add::
 002A BD0000            jsr __enterb
 002D 44                .byte 0x44
 002E                 clock.17::	
                       ; }
                       ; 
                       ; ////////////////////////////////////////////////////////////////////////////////
                       ; 
                       ; PRESTO_TIME_T clock_add(PRESTO_TIME_T clock, unsigned short time) {
                       ;    clock.l=clock.l+time;
 002E EC0A              ldd 10,x
 0030 C30002            addd #2
 0033 ED02              std 2,x
 0035 1AEE02            ldy 2,x
 0038 18EC00            ldd 0,y
 003B E30C              addd 12,x
 003D 1AEE02            ldy 2,x
 0040 18ED00            std 0,y
 0043                 clock.18::	
                       ;    if(clock.l<time) {
 0043 EC0A              ldd 10,x
 0045 C30002            addd #2
 0048 188F              xgdy
 004A 18EC00            ldd 0,y
 004D 1AA30C            cpd 12,x
 0050 240F              bhs L10
 0052                 clock.20::	
                       ;       // carry
                       ;       clock.h++;
 0052 1AEE0A            ldy 10,x
 0055 18EC00            ldd 0,y
 0058 C30001            addd #1
 005B 1AEE0A            ldy 10,x
 005E 18ED00            std 0,y
 0061                 clock.21::	
                       ;    }
 0061                 L10:
 0061                 clock.22::	
                       ;    return clock;
 0061 EC06              ldd 6,x
 0063 1AEE0A            ldy 10,x
 0066 3C                pshx
 0067 8F                xgdx
 0068 CC0004            ldd #4
 006B BD0000            jsr __asgnblk
 006E 38                pulx
 006F                 L8:
 006F 8F                xgdx
 0070 C30004            addd #4
 0073 8F                xgdx
 0074 35                txs
 0075 38                pulx
 0076 1838              puly
 0078 39                rts
                       ;  IX -> 0,x
                       ;              B -> 8,x
                       ;              A -> 4,x
 0079                 _clock_compare::
 0079 37                pshb
 007A 36                psha
 007B 3C                pshx
 007C 30                tsx
 007D 3C                pshx
 007E 30                tsx
 007F                 clock.28::	
                       ; }
                       ; 
                       ; ////////////////////////////////////////////////////////////////////////////////
                       ; 
                       ; signed char clock_compare(PRESTO_TIME_T A,PRESTO_TIME_T B) {
                       ;    if(A.h < B.h) return -1;
 007F 1AEE04            ldy 4,x
 0082 18EC00            ldd 0,y
 0085 1AEE08            ldy 8,x
 0088 CDA300            cpd 0,y
 008B 240D              bhs L13
 008D CCFFFF            ldd #-1
 0090 8F                xgdx
 0091 C30002            addd #2
 0094 8F                xgdx
 0095 35                txs
 0096 38                pulx
 0097 1838              puly
 0099 39                rts
 009A                 L13:
 009A                 clock.29::	
                       ;    if(A.h > B.h) return 1;
 009A 1AEE04            ldy 4,x
 009D 18EC00            ldd 0,y
 00A0 1AEE08            ldy 8,x
 00A3 CDA300            cpd 0,y
 00A6 230D              bls L15
 00A8 CC0001            ldd #1
 00AB 8F                xgdx
 00AC C30002            addd #2
 00AF 8F                xgdx
 00B0 35                txs
 00B1 38                pulx
 00B2 1838              puly
 00B4 39                rts
 00B5                 L15:
 00B5                 clock.31::	
                       ;    // we now know that A.h == B.h
                       ;    if(A.l < B.l) return -1;
 00B5 EC04              ldd 4,x
 00B7 C30002            addd #2
 00BA 188F              xgdy
 00BC 18EC00            ldd 0,y
 00BF 37                pshb ; 
 00C0 36                psha ; spill
 00C1 EC08              ldd 8,x
 00C3 C30002            addd #2
 00C6 188F              xgdy
 00C8 32                pula ; 
 00C9 33                pulb ; reload
 00CA CDA300            cpd 0,y
 00CD 240D              bhs L17
 00CF CCFFFF            ldd #-1
 00D2 8F                xgdx
 00D3 C30002            addd #2
 00D6 8F                xgdx
 00D7 35                txs
 00D8 38                pulx
 00D9 1838              puly
 00DB 39                rts
 00DC                 L17:
 00DC                 clock.32::	
                       ;    if(A.l > B.l) return 1;
 00DC EC04              ldd 4,x
 00DE C30002            addd #2
 00E1 188F              xgdy
 00E3 18EC00            ldd 0,y
 00E6 37                pshb ; 
 00E7 36                psha ; spill
 00E8 EC08              ldd 8,x
 00EA C30002            addd #2
 00ED 188F              xgdy
 00EF 32                pula ; 
 00F0 33                pulb ; reload
 00F1 CDA300            cpd 0,y
 00F4 230D              bls L19
 00F6 CC0001            ldd #1
 00F9 8F                xgdx
 00FA C30002            addd #2
 00FD 8F                xgdx
 00FE 35                txs
 00FF 38                pulx
 0100 1838              puly
 0102 39                rts
 0103                 L19:
 0103                 clock.33::	
                       ;    return 0;
 0103 CC0000            ldd #0
 0106 8F                xgdx
 0107 C30002            addd #2
 010A 8F                xgdx
 010B 35                txs
 010C 38                pulx
 010D 1838              puly
 010F 39                rts
 0110                 L12:
 0110 8F                xgdx
 0111 C30002            addd #2
 0114 8F                xgdx
 0115 35                txs
 0116 38                pulx
 0117 1838              puly
 0119 39                rts
